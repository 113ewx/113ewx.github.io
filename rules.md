# 專案開發規範 (Project Rules)

## 1. 核心邏輯原則
### 1.1 實質價值運算 (Real Value Calculation)
- **輸入 (Input)**：使用者填寫 **名目數據 (Nominal)** (如報酬率 10%、通膨率 2.5%) 以符合直覺。
- **運算 (Process)**：系統內部將名目報酬率轉換為 **實質報酬率 (Real Return)** 進行模擬。公式：$R_{real} = \frac{1 + R_{nominal}}{1 + R_{inflation}} - 1$。
- **輸出 (Output)**：所有圖表與金額皆顯示 **實質購買力 (Real Purchasing Power)** (以今日幣值為準)。

### 1.2 蒙地卡羅模擬 (Monte Carlo Simulation)
- 使用 **Box-Muller Transform** 產生常態分佈亂數。
- 預設模擬次數：主圖表 10,000 次，Solver 求解器 2,000 次 (迭代 12 輪)。

### 1.3 幾何平均與波動耗損
- 承認「波動耗損 (Volatility Drag)」。
- 長期複利的數學期望值應接近幾何平均 (Geometric Mean)。

### 1.4 財富自由判定 (FIRE Condition)
- **判定標準**：若 (目前本金) > (未來所有年份的實質開銷總和)，視為已財富自由。
- **意義**：即便未來投資回報為 0% (僅抗通膨)，本金也足以花到終老，此為最保守的安全狀態。

## 2. 智能診斷系統 (Diagnostic System)
### 2.1 求解策略 (Iterative Solver)
- **方法**：數值分析法 (Iterative Numerical Method)。
- **流程**：設定邊界 -> 調整參數 -> 微型模擬 (N=2000) -> 檢查成功率 -> 收斂。

### 2.2 方案定義
- **Scheme A (起點加碼)**：保持成長率不變，僅提高初始每月投入金額。
- **Scheme B (延後退休)**：延長工作年限，同時縮短退休年限。
- **Scheme C (節省開支)**：降低退休後的每月目標花費。

## 3. 介面設計規範 (UI/UX)
### 3.1 頁籤式架構 (Tab Structure)
- **Tab 1 模擬器**：核心功能區。
- **Tab 2 使用說明**：名詞解釋與教學。

### 3.2 卡片系統 (Card System)
- **Visual**：深色實底 (Dark Surface) + 左側強調邊框 (Accent Border)。
- **Gold Card (財富自由)**：金黑配色，皇冠 Icon，顯示「忽略投資收益」標籤。
- **Green Card (投資可行)**：綠黑配色，勾勾 Icon，顯示「持續投入/複利」標籤。
- **Red Card (發現風險)**：紅黑配色，燈泡 Icon，顯示 A/B/C 三種解決方案。

### 3.3 投資模板 (Investment Templates)
- **名目數據**：
    - **100% 0050**：名目 10.0%, 波動 15.0%
    - **100% VTI**：名目 10.5%, 波動 14.0%
    - **100% VT**：名目 8.4%, 波動 15.0%
    - **60/40 股債**：名目 6.5%, 波動 10.0%
- **行為**：選擇後自動填入參數並觸發運算；手動修改參數後自動切回「Custom」。

## 4. 程式碼風格
- **註解**：必須使用 **繁體中文**。
- **變數命名**：清楚的英文單字 (CamelCase)。
- **結構**：核心模擬 (`coreSimulate`) 與 UI 邏輯分離。